<dom-module id="sp-connection-info">
  <style>
    paper-button.sp-connection-info {
      cursor: pointer;
      text-decoration: underline;
    }
  </style>
  <template>
    <div class="current-user">
      <img class="avatar" src="{{_avatar}}" alt=""/>
      <span class="name">{{_fullName}}</span>
      <div><paper-button on-click="disconnect"><div data-i18n="[html]silverpeas.header.logout;"></div></paper-button></div>
    </div>
  </template>
</dom-module>

<script type="text/javascript" src="../../scripts/jquery/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../../bower_components/i18next/i18next.js"></script>
<link rel="import" href="../../locales/fr/translation.json">
<script>
  (function() {
    Polymer({
      is: 'sp-connection-info',
      behaviors: [SessionBehavior],
      properties: {
        _fullName: {
          type: String,
          computed: '_computeFullNameOf(user)'
        },
        _avatar: {
          type: String,
          computed: '_computeAvatarUrlOf(user)'
        }
      },
      _computeFullNameOf: function(user) {
        return (user == null ? '':user.firstName + ' ' + user.lastName);
      },
      _computeAvatarUrlOf: function(user) {
        return (user == null ? '':'http://localhost:8000/' + user.avatar);
      },
      disconnect: function() {
        console.log('disconnection asked by ' + this._fullName);
        this.closeSession();
      },
      ready: function() {
        console.log('element ready!');
      }
    });
  })();
</script>
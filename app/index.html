<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <title>POC > Accueil</title>
  <meta name="description" content=""/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png"/>
  <link rel="icon" href="favicon.ico" sizes="16x16" type="image/vnd.microsoft.icon">
  <link rel="stylesheet" type="text/css" href="styles/styles.css"/>
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="bower_components/page/page.js"></script>
  <link rel="import" href="elements/elements.html">
  <script type="text/javascript" src="bower_components/ckeditor/ckeditor.js"></script>
  <link rel="import" href="locales/fr/translation.json">
</head>
<body unresolved class="page-home w100 flexbox-v">
<template is="dom-bind" id="app">
  <div class="header-container">
    <header id="header" class="wrapper clearfix txtcenter">
      <h1 class="title"><img src="images/logo-header.png" alt="silverpeas"/></h1>
      <sp-connection-info login-page='/login.html' user="{{currentUser}}"></sp-connection-info>
      <sp-space-header-menu context="[[context]]"></sp-space-header-menu>
    </header>
  </div>
  <div class="main-container flexitem-fluid">
    <iron-pages attr-for-selected="data-route" selected="{{route}}">
      <paper-material data-route="home" elevation="1">
        <sp-home-page></sp-home-page>
      </paper-material>
      <paper-material data-route="space-home" elevation="1">
        <sp-space context="[[context]]"></sp-space>
      </paper-material>
      <paper-material data-route="instance-home" elevation="1">
        <sp-app-instance context="[[context]]"></sp-app-instance>
      </paper-material>
    </iron-pages>
  </div>
  <sp-notifier id="noty1" text="Hey !" auto>
    Bienvenue <b><span>{{currentUser.firstName}}</span> <span>{{currentUser.lastName}}</span></b>
  </sp-notifier>
  <!-- #main-container -->
  <div class="footer-container pam">
    <footer class="wrapper">
      <div id="footerContent" data-i18n="[html]silverpeas.footer.copyright"></div>
    </footer>
  </div>
  <a id="transition" style="display: none"></a>
  <iron-a11y-announcer mode="off"></iron-a11y-announcer>
</template>
<script>
  (function(document) {
    'use strict';

    var CKEDITOR_BASEPATH = 'bower_components/ckeditor/';

    window.addEventListener('WebComponentsReady', function() {
      var app = document.querySelector('#app');
      app.context = NavigationContextBehavior.init(app);

      // apply dynamically some style classes
      (function() {
        var header = document.getElementById("header");

        function scrolled() {
          var windowHeight = document.body.clientHeight, currentScroll = document.body.scrollTop ||
              document.documentElement.scrollTop;

          document.getElementById("header").className =
              (currentScroll >= 273) ? "wrapper clearfix txtcenter fixed" :
                  "wrapper clearfix txtcenter";
        }

        addEventListener("scroll", scrolled, false);
      })();

      // load routing rules.
      (function() {
        // route to a space home page.
        page('/spaces/:id', function(data) {
          app.context.ofSpace(data);
        });

        // route to an application instance home page.
        page('/instances/:id', function(data) {
          app.context.ofApplicationInstance(data);
        });

        // route to an application instance inner page; he control is passed to the home page
        // component of the application instance.
        page('/instances/:id/:resource/:rid', function(data) {
          app.context.ofApplicationInstance(data);
        });

        // route to the home page.
        page('*', function(data) {
          app.context.ofUnknown(data);
        });

        // add #! before urls
        page({
          hashbang : true
        });

        page('/login.html', function() {
        });

        page('/yocha.html', function() {
        });

        console.log("routing loaded!");
      })();

      document.querySelector('body').removeAttribute('unresolved');

      Polymer.dom(document.body).querySelector('h1').addEventListener('click', function(e) {
        document.location = "/yocha.html";
      });
    });
  })(document);

</script>
</body>
</html>
